import{_ as s,o as n,c as a,Q as e}from"./chunks/framework.82820f36.js";const l="/Alan-blog/assets/nginx1.d907b02a.jpg",p="/Alan-blog/assets/nginx2.1a698ba6.jpg",c="/Alan-blog/assets/nginx3.412c3f03.jpg",h=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"deploy/nginx.md","filePath":"deploy/nginx.md","lastUpdated":1699544553000}'),i={name:"deploy/nginx.md"},o=e('<h2 id="windows-nginx安装" tabindex="-1">windows nginx安装 <a class="header-anchor" href="#windows-nginx安装" aria-label="Permalink to &quot;windows nginx安装&quot;">​</a></h2><p>进入官网下载地址<a href="https://nginx.org/en/download.html%EF%BC%8C%E7%82%B9%E5%87%BB%E4%B8%8B%E8%BD%BDwindows%E7%89%88%E6%9C%AC" target="_blank" rel="noreferrer">https://nginx.org/en/download.html，点击下载windows版本</a><img src="'+l+'" alt="下载nginx"> 下载后的文件夹解压到一个没有中文的路径 <img src="'+p+'" alt="解压nginx"> 这个时候可以双击nginx.exe，直接启动nginx，但是这样启动出错了看不到原因，推荐使用命令行启动 <img src="'+c+`" alt="启动nginx"> 这个时候没有报错，nginx就启动成功了，想要关闭nginx这个时候关闭窗口是没有用的，需要用nginx -S stop或者任务管理器去关闭</p><h2 id="配置nginx" tabindex="-1">配置nginx <a class="header-anchor" href="#配置nginx" aria-label="Permalink to &quot;配置nginx&quot;">​</a></h2><p>安装完成后，进入到conf下，找到nginx.conf文件，然后选择一个编辑器把他打开，最好是有nginx提示的那种，然后就会出现类似下面的配置</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;">http {</span></span>
<span class="line"><span style="color:#dbd7caee;">    include       mime.types;</span></span>
<span class="line"><span style="color:#dbd7caee;">    default_type  application/octet-stream;</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">    sendfile        on;</span></span>
<span class="line"><span style="color:#dbd7caee;">    #tcp_nopush     on;</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">    #keepalive_timeout  0;</span></span>
<span class="line"><span style="color:#dbd7caee;">    keepalive_timeout  65;</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">    #gzip  on;</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">    server {</span></span>
<span class="line"><span style="color:#dbd7caee;">        listen       81;</span></span>
<span class="line"><span style="color:#dbd7caee;">        server_name  localhost;</span></span>
<span class="line"><span style="color:#dbd7caee;">        ...</span></span>
<span class="line"><span style="color:#dbd7caee;">    }</span></span>
<span class="line"><span style="color:#dbd7caee;">}</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393a34;">http {</span></span>
<span class="line"><span style="color:#393a34;">    include       mime.types;</span></span>
<span class="line"><span style="color:#393a34;">    default_type  application/octet-stream;</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">    sendfile        on;</span></span>
<span class="line"><span style="color:#393a34;">    #tcp_nopush     on;</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">    #keepalive_timeout  0;</span></span>
<span class="line"><span style="color:#393a34;">    keepalive_timeout  65;</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">    #gzip  on;</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">    server {</span></span>
<span class="line"><span style="color:#393a34;">        listen       81;</span></span>
<span class="line"><span style="color:#393a34;">        server_name  localhost;</span></span>
<span class="line"><span style="color:#393a34;">        ...</span></span>
<span class="line"><span style="color:#393a34;">    }</span></span>
<span class="line"><span style="color:#393a34;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>在同级server下添加你想转发的内容，类似下面这样，把acl的请求转发到3000端口，把sys的请求转发到4000端口</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;">server {</span></span>
<span class="line"><span style="color:#dbd7caee;">    listen       81;</span></span>
<span class="line"><span style="color:#dbd7caee;">    server_name  localhost;</span></span>
<span class="line"><span style="color:#dbd7caee;">    ...</span></span>
<span class="line"><span style="color:#dbd7caee;">}</span></span>
<span class="line"><span style="color:#dbd7caee;">server {</span></span>
<span class="line"><span style="color:#dbd7caee;">    listen 9001;</span></span>
<span class="line"><span style="color:#dbd7caee;">    server_name localhost;</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">    location ~ /acl/ {</span></span>
<span class="line"><span style="color:#dbd7caee;">        proxy_pass http://localhost:3000;</span></span>
<span class="line"><span style="color:#dbd7caee;">    }</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">    location ~ /sys/ {</span></span>
<span class="line"><span style="color:#dbd7caee;">        proxy_pass http://localhost:4000;</span></span>
<span class="line"><span style="color:#dbd7caee;">    }</span></span>
<span class="line"><span style="color:#dbd7caee;">}</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393a34;">server {</span></span>
<span class="line"><span style="color:#393a34;">    listen       81;</span></span>
<span class="line"><span style="color:#393a34;">    server_name  localhost;</span></span>
<span class="line"><span style="color:#393a34;">    ...</span></span>
<span class="line"><span style="color:#393a34;">}</span></span>
<span class="line"><span style="color:#393a34;">server {</span></span>
<span class="line"><span style="color:#393a34;">    listen 9001;</span></span>
<span class="line"><span style="color:#393a34;">    server_name localhost;</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">    location ~ /acl/ {</span></span>
<span class="line"><span style="color:#393a34;">        proxy_pass http://localhost:3000;</span></span>
<span class="line"><span style="color:#393a34;">    }</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">    location ~ /sys/ {</span></span>
<span class="line"><span style="color:#393a34;">        proxy_pass http://localhost:4000;</span></span>
<span class="line"><span style="color:#393a34;">    }</span></span>
<span class="line"><span style="color:#393a34;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="nginx命令" tabindex="-1">nginx命令 <a class="header-anchor" href="#nginx命令" aria-label="Permalink to &quot;nginx命令&quot;">​</a></h2><p><strong>启动 nginx</strong></p><p>进入到 /usr/local/nginx 目录，</p><p>接着我们进入到 sbin 目录，通过如下命令启动 nginx：</p><div class="language-css vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#666666;font-style:italic;">.</span><span style="color:#FDAEB7;font-style:italic;">/nginx</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#999999;font-style:italic;">.</span><span style="color:#B31D28;font-style:italic;">/nginx</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>当然你也可以配置环境命令，这样在任意目录都能启动 nginx。</p><p>可以输入如下命令，查看 nginx 是否有服务正在运行：</p><div class="language-css vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">ps -ef </span><span style="color:#666666;">|</span><span style="color:#DBD7CAEE;"> grep nginx</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393A34;">ps -ef </span><span style="color:#999999;">|</span><span style="color:#393A34;"> grep nginx</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>关闭 nginx</strong></p><p>有两种方式：</p><p>方式1：快速停止</p><div class="language-css vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">cd /usr/local/nginx/sbin</span></span>
<span class="line"><span style="color:#666666;font-style:italic;">.</span><span style="color:#FDAEB7;font-style:italic;">/nginx</span><span style="color:#DBD7CAEE;"> -s </span><span style="color:#4D9375;">stop</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393A34;">cd /usr/local/nginx/sbin</span></span>
<span class="line"><span style="color:#999999;font-style:italic;">.</span><span style="color:#B31D28;font-style:italic;">/nginx</span><span style="color:#393A34;"> -s </span><span style="color:#1E754F;">stop</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>此方式相当于先查出nginx进程id再使用kill命令强制杀掉进程。不太友好。</p><p>方式2：平缓停止</p><div class="language-css vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">cd /usr/local/nginx/sbin</span></span>
<span class="line"><span style="color:#666666;font-style:italic;">.</span><span style="color:#FDAEB7;font-style:italic;">/nginx</span><span style="color:#DBD7CAEE;"> -s quit</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393A34;">cd /usr/local/nginx/sbin</span></span>
<span class="line"><span style="color:#999999;font-style:italic;">.</span><span style="color:#B31D28;font-style:italic;">/nginx</span><span style="color:#393A34;"> -s quit</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>此方式是指允许 nginx 服务将当前正在处理的网络请求处理完成，但不在接收新的请求，之后关闭连接，停止工作。</p><p><strong>重启 nginx</strong></p><div class="language-css vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">service nginx restart</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393A34;">service nginx restart</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>方式1：先停止再启动</p><div class="language-css vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#666666;font-style:italic;">.</span><span style="color:#FDAEB7;font-style:italic;">/nginx</span><span style="color:#DBD7CAEE;"> -s quit</span></span>
<span class="line"><span style="color:#666666;font-style:italic;">.</span><span style="color:#FDAEB7;font-style:italic;">/nginx</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#999999;font-style:italic;">.</span><span style="color:#B31D28;font-style:italic;">/nginx</span><span style="color:#393A34;"> -s quit</span></span>
<span class="line"><span style="color:#999999;font-style:italic;">.</span><span style="color:#B31D28;font-style:italic;">/nginx</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>相当于先执行停止命令再执行启动命令。</p><p>方式2：重新加载配置文件</p><div class="language-css vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#666666;font-style:italic;">.</span><span style="color:#FDAEB7;font-style:italic;">/nginx</span><span style="color:#DBD7CAEE;"> -s reload</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#999999;font-style:italic;">.</span><span style="color:#B31D28;font-style:italic;">/nginx</span><span style="color:#393A34;"> -s reload</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>通常我们使用nginx修改最多的便是其配置文件 nginx.conf。修改之后想要让配置文件生效而不用重启 nginx，便可以使用此命令。</p><p><strong>检测配置文件语法是否正确</strong></p><p>方式1：通过如下命令，指定需要检查的配置文件</p><div class="language-css vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">nginx -t -c  /usr/local/nginx/conf/nginx</span><span style="color:#666666;">.</span><span style="color:#BD976A;">conf</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393A34;">nginx -t -c  /usr/local/nginx/conf/nginx</span><span style="color:#999999;">.</span><span style="color:#B07D48;">conf</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>方式2：通过如下命令，不加 -c 参数，默认检测nginx.conf 配置文件。</p><div class="language-css vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">nginx -t</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393A34;">nginx -t</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div>`,36),t=[o];function r(d,b,y,g,u,v){return n(),a("div",null,t)}const x=s(i,[["render",r]]);export{h as __pageData,x as default};
